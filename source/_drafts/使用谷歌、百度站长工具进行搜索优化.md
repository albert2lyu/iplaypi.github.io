---
title: 使用谷歌、百度站长工具进行搜索优化
id: 2019-07-30 00:40:37
date: 2018-05-24 00:40:37
updated: 2019-08-11 00:40:37
categories:
tags:
keywords:
---
优化待整理
<!-- more -->


2018052401
建站
seo,SEO,Google,Baidu,SHell,Hexo,travis

# 百度站长工具


配置域名，认证过程，htps认证，反抓取配置文件。

**链接提交**方式有两种：**自动提交**、**手动提交**。

切记，各种提交方式有自己的优缺点，最好要配合使用，不建议只使用其中一种，要把资源利用起来。

## 自动提交

**自动提交**有多种推送方式：**主动推送（实时）**、**自动推送**、**sitemap**。

#### 主动推送

为了提高提交链接的频率，把**自动提交**中的**主动推送**方法也用起来，作为工程师，肯定不会手动去整理 url 文件然后提交，而是要使用自动化的方式。

其实我的方案也很简单，使用 Shell 脚本，自动收集 url 追加到指定的文件，然后在 travis 的自动构件脚本中添加百度站长提供的 curl 命令进行**主动推送**。为了防止秘钥泄露，在构建脚本中使用秘钥变量，把秘钥的值保存在 travis 系统中。

以下涉及的 `Shell` 脚本已经被我上传至 `GitHub`，读者可以提前下载查看：[auto_collect_urls.sh](https://github.com/iplaypi/iplaypi.github.io/tree/source) ，脚本命名与下文中描述一致。

我的 `Shell` 脚本为 `auto_collect_urls.sh`，内容如下：

```
#!/bin/bash
# urls 文件 
urls=./baidu_urls.txt
# url 格式 
content_pattern='https://www.playpi.org/id.html'
# 遍历文件夹内的所有文件 
for file in ./source/_posts/*.md
do
  if [ -f $file ]; then
    # 获取单个文件的 id【在第 3 行】
    echo '================================================================'
    # echo '====read file:' $file
    var1=$(grep -nE '^id: [0-9]{10}' $file | grep -E '^3:id: [0-9]{10}' | awk -F': ' '{print $2;}')
    # echo '====read id:' $var1
    # 判断非空必须使用双引号，否则逻辑错误 
    if [ -n "$var1" ]; then
      has=$(grep $var1 $urls)
      # 为空，表示 id 不在 urls 文件中，has 变量切记使用双引号 
      if [ -z "$has" ]; then
        # 字符串搜索替换，待搜索字符串是变量，不是字符串本身，// 表示替换所有 
        content=${content_pattern//id/$var1}
        # 追加到 urls 文件中 
        echo '====prepare append to urls:' $content
        echo $content >> $urls
      else
      # 在 urls 文件中已经存在，无需处理 
      echo '====urls has:' $var1
      fi
    else
    echo '!!!!invalid var:' $var1
    fi
  else
  echo '!!!!invalid file:' $file
  fi
done
```

生成的 `url` 集合文件为 `baidu_urls.txt`，紧接着，在 `travis` 的构建脚本中添加如下内容【注意要在能识别 `Linux` 命令的位置添加，例如 `before_install:` 中，构建脚本参考：[.travis.yml](https://github.com/iplaypi/iplaypi.github.io/tree/source)】：

```
before_install:
...
# 主动推送 urls 到百度站长
- echo 'start push urls to baidu'
- echo ${URLS_FILE}
- echo $(curl -H 'Content-Type:text/plain' --data-binary @${URLS_FILE} "http://data.zz.baidu.com/urls?site=https://www.playpi.org&token=${BAIDU_TOKEN}")
- echo 'finish push urls to baidu'
```

其中，`URLS_FILE`、`BAIDU_TOKEN` 这两个变量需要在 `travis` 中设置，并且选择在构建的日志中隐藏，防止泄露。

![在 travis 中设置变量](https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/2018/20190731003921.png "在 travis 中设置变量")

提交代码触发一次 `travis` 构建，在构建日志中可以看到**主动推送** `urls` 到百度站长的结果，成功推送93条，剩余4999442条，如图。

![查看 travis 局部构建日志](https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/2018/20190731003715.png "查看 travis 局部构建日志")

由于百度站长的**链接提交**统计有延迟，所以需要等待两天，再去观察效果。

我为了对比效果，想多看几天的数据，所以等待了五天才去看**链接提交**的数据量，可以看到，在07-30、08-02这两天分别有几百条链接提交，数据量这么多是因为我重复提交的缘故，其实只有几十条链接。但是，我每天都有提交，理论上应该每天都有几十条链接被统计，可能是百度站长去重的缘故。

![查看主动推送效果](https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/2018/20190804154642.jpg "查看主动推送效果")

### 自动推送

这种方式会在用户点击页面时自动推送网页的地址给百度站长，比较自动化。

但是如果一个页面一直没有点击，就永远不会推送给百度站长，知识缺点。

需要在代码中添加指定的 `Javascript` 代码。

可以使用插件自动开启，`Hexo` 在 `generate` 时会自动添加。

### 站点地图

**站点地图**即 `sitemap` 推送的方式，需要提供一个符合百度站长标准的 `xml` 文本文件。

可以使用插件自动生成。

## 手动提交

直接在页面填写网站的 `url`，点击**提交**按钮即可，每次手动操作麻烦，不够自动化，偶尔使用一次还行。


# 谷歌站长工具


更好用，效果更好。

站点地图，需要提供一个符合谷歌站长的 `xml` 文本文件。

可以使用插件自动生成。

